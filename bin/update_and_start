#!/usr/bin/env bash
# Script for updating and (re)starting the server. 
set -e

PROJECT_DIR=/home/auke/projects/virtualtherapist-web/
PID_FILE=/tmp/play.pid

git pull origin feature/57

echo "Preparing application for launch."
activator clean stage

if [ -f $PID_FILE ]; then
  echo "Stopping server."
  kill $(cat $PID_FILE)
fi

echo "Launching application."
# Launch application in backgroud and redirect all output to /dev/null/.
authbind $PROJECT_DIR"target/universal/stage/bin/virtualcoach-web" -Dhttp.port=80 -Dpidfile.path=/tmp/play.pid >/dev/null 2>&1 &
